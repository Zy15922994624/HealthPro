<view class="container"><view class="card diet-card"><view class="card-header"><text class="title">今日饮食</text><text data-event-opts="{{[['tap',[['navigateTo',['/pages/diet/diet']]]]]}}" class="more" bindtap="__e">查看详情 ></text></view><view class="meal-buttons"><block wx:for="{{$root.l0}}" wx:for-item="meal" wx:for-index="__i0__" wx:key="type"><view data-event-opts="{{[['tap',[['showAddForm',['$0'],[[['mealTypes','type',meal.$orig.type,'type']]]]]]]}}" class="meal-btn" bindtap="__e"><text class="meal-name">{{meal.$orig.name}}</text><text class="meal-status">{{meal.m0}}</text></view></block></view><view class="nutrition-info"><view class="nutrition-item"><text class="label">热量</text><text class="value">{{todayStats.calories||'--'}}</text><text class="unit">千卡</text></view><view class="nutrition-item"><text class="label">蛋白质</text><text class="value">{{todayStats.protein||'--'}}</text><text class="unit">g</text></view><view class="nutrition-item"><text class="label">碳水</text><text class="value">{{todayStats.carbohydrate||'--'}}</text><text class="unit">g</text></view></view></view><view class="card health-card"><view class="card-header"><text class="title">健康概览</text><text data-event-opts="{{[['tap',[['navigateToHealth',['$event']]]]]}}" class="more" bindtap="__e">查看详情 ></text></view><view class="health-grid"><view class="health-item"><text class="label">BMI指数</text><view class="value-wrap"><text class="{{['value',latestHealth.bmiStatus]}}">{{latestHealth.bmi||'--'}}</text><text class="status">{{evaluation.bmiStatus||'暂无数据'}}</text></view></view><view class="health-item"><text class="label">血压</text><view class="value-wrap"><text class="{{['value',latestHealth.bloodPressureStatus]}}">{{''+(latestHealth.bloodPressureSystolic||'--')+"/"+(latestHealth.bloodPressureDiastolic||'--')+''}}</text><text class="status">{{evaluation.bloodPressureStatus||'暂无数据'}}</text></view></view></view><view class="record-info"><text class="record-time">{{$root.m1}}</text></view></view><view hidden="{{!(!isAddFormVisible)}}" class="card trend-card"><view class="card-header"><text class="title">趋势分析</text></view><view class="indicator-tabs"><block wx:for="{{indicators}}" wx:for-item="item" wx:for-index="__i1__" wx:key="key"><view data-event-opts="{{[['tap',[['switchIndicator',['$0'],[[['indicators','key',item.key,'key']]]]]]]}}" class="{{['tab-item',currentIndicator===item.key?'active':'']}}" bindtap="__e">{{''+item.name+''}}</view></block></view><swiper class="charts-swiper" current="{{swiperCurrent}}" circular="{{false}}" skip-hidden-item-layout="{{true}}" display-multiple-items="{{1}}" next-margin="{{0}}" previous-margin="{{0}}" data-event-opts="{{[['change',[['onSwiperChange',['$event']]]]]}}" bindchange="__e"><block wx:for="{{indicators}}" wx:for-item="item" wx:for-index="index" wx:key="key"><swiper-item><view class="chart-container"><qiun-data-charts vue-id="{{'8dd740cc-1-'+index}}" type="line" chartData="{{trendData[item.key]}}" opts="{{chartOpts[item.key]}}" canvas2d="{{true}}" canvasId="{{'trend-chart-'+index}}" bind:__l="__l"></qiun-data-charts></view></swiper-item></block></swiper></view><uni-popup class="vue-ref" vue-id="8dd740cc-2" type="bottom" data-ref="addPopup" data-event-opts="{{[['^change',[['onPopupChange']]]]}}" bind:change="__e" bind:__l="__l" vue-slots="{{['default']}}"><view class="add-form"><view class="form-header"><text class="title">{{$root.m2}}</text><text data-event-opts="{{[['tap',[['e0',['$event']]]]]}}" class="close" bindtap="__e">×</text></view><view class="search-box"><input class="search-input" type="text" placeholder="搜索食物" data-event-opts="{{[['input',[['__set_model',['','searchKey','$event',[]]],['onSearch',['$event']]]]]}}" value="{{searchKey}}" bindinput="__e"/></view><block wx:if="{{$root.g0}}"><scroll-view class="food-list" scroll-y="{{true}}"><block wx:for="{{filteredFoods}}" wx:for-item="food" wx:for-index="__i2__" wx:key="id"><view data-event-opts="{{[['tap',[['selectFood',['$0'],[[['filteredFoods','id',food.id]]]]]]]}}" class="food-item" bindtap="__e"><text class="name">{{food.name}}</text><text class="calories">{{food.calories+"千卡/100g"}}</text></view></block></scroll-view></block><block wx:else><block wx:if="{{searchKey}}"><view class="no-result"><text>未找到相关食物</text></view></block></block><block wx:if="{{formData.foodId}}"><view class="selected-food"><view class="food-info"><text class="name">{{selectedFoodName}}</text><text class="unit">每100g</text></view><view class="nutrition-info"><text>{{"热量: "+selectedFood.calories+"千卡"}}</text><text>{{"蛋白质: "+selectedFood.protein+"g"}}</text><text>{{"脂肪: "+selectedFood.fat+"g"}}</text><text>{{"碳水: "+selectedFood.carbohydrate+"g"}}</text></view><view class="weight-input"><text class="label">食用重量(g)</text><input class="input" type="number" data-event-opts="{{[['input',[['__set_model',['$0','foodWeight','$event',[]],['formData']],['calculateNutrition',['$event']]]]]}}" value="{{formData.foodWeight}}" bindinput="__e"/></view><block wx:if="{{formData.foodWeight}}"><view class="calculated-nutrition"><text>实际摄入</text><text>{{"热量: "+$root.g1+"千卡"}}</text><text>{{"蛋白质: "+$root.g2+"g"}}</text><text>{{"脂肪: "+$root.g3+"g"}}</text><text>{{"碳水: "+$root.g4+"g"}}</text></view></block></view></block><button class="submit-btn" disabled="{{!isFormValid}}" data-event-opts="{{[['tap',[['submitForm',['$event']]]]]}}" bindtap="__e">确认添加</button></view></uni-popup></view>